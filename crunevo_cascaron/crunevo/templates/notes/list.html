{% extends 'base.html' %}
{% block content %}
<h2>Apuntes</h2>
<div class="mb-3">
  <input type="text" id="noteSearch" class="form-control" placeholder="Buscar...">
</div>
<a href="{{ url_for('notes.upload_note') }}" class="btn btn-success mb-3">Subir nuevo</a>
  <ul class="list-group" id="notesList">
{% for note in notes %}
  <li class="list-group-item">
    <a href="{{ url_for('notes.detail', note_id=note.id) }}">{{ note.title }}</a> - {{ note.views }} vistas
  </li>
{% endfor %}
  </ul>
<script>
document.getElementById('noteSearch').addEventListener('input', function(e){
  fetch('{{ url_for('notes.search_notes') }}?q=' + encodeURIComponent(e.target.value))
    .then(r => r.json())
    .then(data => {
      const list = document.getElementById('notesList');
      list.innerHTML = '';
      data.forEach(n => {
        const li = document.createElement('li');
        li.className = 'list-group-item';
        li.innerHTML = `<a href="/notes/${n.id}">${n.title}</a>`;
        list.appendChild(li);
      });
    });
});
</script>
{% endblock %}
