
<div class="kanban-content">
    <div class="kanban-columns" data-kanban-id="{{ block.id }}">
        {% set columns = block.get_metadata().get('columns', {}) %}
        {% for column_name, tasks in columns.items() %}
        <div class="kanban-column" data-column="{{ column_name }}">
            <div class="column-header">
                <h6>{{ column_name }}</h6>
                <span class="task-count">{{ tasks|length }}</span>
            </div>
            <div class="column-tasks" data-column-tasks="{{ column_name }}">
                {% for task in tasks %}
                <div class="kanban-task" data-task-id="{{ loop.index0 }}">
                    <div class="task-content">
                        <h6>{{ task.title }}</h6>
                        {% if task.description %}
                        <p>{{ task.description[:50] }}{% if task.description|length > 50 %}...{% endif %}</p>
                        {% endif %}
                    </div>
                    {% if task.priority %}
                    <div class="task-priority priority-{{ task.priority }}">
                        <i class="bi bi-flag-fill"></i>
                    </div>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
        </div>
        {% endfor %}
    </div>
    <button class="btn btn-sm btn-outline-primary mt-2" onclick="openKanban({{ block.id }})">
        <i class="bi bi-plus"></i>
        Gestionar tablero
    </button>
</div>
