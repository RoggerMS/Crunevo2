{% extends 'base.html' %}
{% from 'components/csrf.html' import csrf_field %}

{% block content %}
<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-md-10 col-lg-8">
      <div class="card shadow-lg border-0 mb-3">
        <div class="card-header bg-success text-white text-center py-4">
          <h3 class="mb-0">
            <i class="bi bi-pencil-square me-2"></i>
            Editar Club: {{ club.name }}
          </h3>
          <p class="mb-0 mt-2 opacity-75">Actualiza la información de tu club académico</p>
        </div>
        
        <div class="card-body p-4 p-md-5">
          <form method="post" enctype="multipart/form-data">
            {{ csrf_field() }}
            
            <!-- Current Images Preview -->
            {% if club.avatar_url or club.banner_url %}
            <div class="section-header mb-4">
              <h5 class="text-success border-bottom pb-2 mb-3">
                <i class="bi bi-eye me-2"></i>Imágenes Actuales
              </h5>
            </div>
            
            <div class="row g-3 mb-4">
              {% if club.avatar_url %}
              <div class="col-md-6">
                <div class="text-center">
                  <p class="small text-muted mb-2">Avatar Actual</p>
                  <img src="{{ club.avatar_url }}" alt="{{ club.name }}" 
                       class="rounded-circle border-3 border-success" 
                       width="100" height="100" style="object-fit: cover;">
                </div>
              </div>
              {% endif %}
              
              {% if club.banner_url %}
              <div class="col-md-6">
                <div class="text-center">
                  <p class="small text-muted mb-2">Banner Actual</p>
                  <img src="{{ club.banner_url }}" alt="{{ club.name }}" 
                       class="rounded border" 
                       width="200" height="67" style="object-fit: cover;">
                </div>
              </div>
              {% endif %}
            </div>
            {% endif %}
            
            <!-- Basic Information Section -->
            <div class="section-header mb-4">
              <h5 class="text-success border-bottom pb-2 mb-3">
                <i class="bi bi-info-circle me-2"></i>Información Básica
              </h5>
            </div>
            
            <div class="row g-3 mb-4">
              <div class="col-md-6">
                <label for="{{ form.name.id }}" class="form-label fw-semibold">
                  <i class="bi bi-tag me-1"></i>{{ form.name.label.text }}
                </label>
                {{ form.name(class="form-control form-control-lg") }}
                {% if form.name.errors %}
                  <div class="text-danger small mt-1">{{ form.name.errors[0] }}</div>
                {% endif %}
              </div>
              
              <div class="col-md-6">
                <label for="{{ form.career.id }}" class="form-label fw-semibold">
                  <i class="bi bi-mortarboard me-1"></i>{{ form.career.label.text }}
                </label>
                {{ form.career(class="form-control form-control-lg") }}
                {% if form.career.errors %}
                  <div class="text-danger small mt-1">{{ form.career.errors[0] }}</div>
                {% endif %}
              </div>
            </div>
            
            <div class="mb-4">
              <label for="{{ form.description.id }}" class="form-label fw-semibold">
                <i class="bi bi-text-paragraph me-1"></i>{{ form.description.label.text }}
              </label>
              {{ form.description(class="form-control", rows=4) }}
              {% if form.description.errors %}
                <div class="text-danger small mt-1">{{ form.description.errors[0] }}</div>
              {% endif %}
            </div>

            <!-- Images Section -->
            <div class="section-header mb-4">
              <h5 class="text-success border-bottom pb-2 mb-3">
                <i class="bi bi-image me-2"></i>Actualizar Imágenes
              </h5>
            </div>
            
            <div class="row g-3 mb-4">
              <div class="col-md-6">
                <label for="{{ form.avatar.id }}" class="form-label fw-semibold">
                  <i class="bi bi-person-circle me-1"></i>{{ form.avatar.label.text }}
                </label>
                {{ form.avatar(class="form-control", accept="image/*") }}
                {% if form.avatar.errors %}
                  <div class="text-danger small mt-1">{{ form.avatar.errors[0] }}</div>
                {% endif %}
                <div class="form-text">Deja vacío para mantener el avatar actual</div>
              </div>
              
              <div class="col-md-6">
                <label for="{{ form.banner.id }}" class="form-label fw-semibold">
                  <i class="bi bi-image me-1"></i>{{ form.banner.label.text }}
                </label>
                {{ form.banner(class="form-control", accept="image/*") }}
                {% if form.banner.errors %}
                  <div class="text-danger small mt-1">{{ form.banner.errors[0] }}</div>
                {% endif %}
                <div class="form-text">Deja vacío para mantener el banner actual</div>
              </div>
            </div>

            <!-- Social Links Section -->
            <div class="section-header mb-4">
              <h5 class="text-success border-bottom pb-2 mb-3">
                <i class="bi bi-share me-2"></i>Redes Sociales
              </h5>
            </div>
            
            <div class="row g-3 mb-4">
              <div class="col-md-6">
                <label for="{{ form.facebook_url.id }}" class="form-label fw-semibold">
                  <i class="bi bi-facebook text-primary me-1"></i>{{ form.facebook_url.label.text }}
                </label>
                <div class="input-group">
                  <span class="input-group-text bg-light">
                    <i class="bi bi-facebook text-primary"></i>
                  </span>
                  {{ form.facebook_url(class="form-control", placeholder="https://facebook.com/tu-club") }}
                </div>
                {% if form.facebook_url.errors %}
                  <div class="text-danger small mt-1">{{ form.facebook_url.errors[0] }}</div>
                {% endif %}
              </div>
              
              <div class="col-md-6">
                <label for="{{ form.whatsapp_url.id }}" class="form-label fw-semibold">
                  <i class="bi bi-whatsapp text-success me-1"></i>{{ form.whatsapp_url.label.text }}
                </label>
                <div class="input-group">
                  <span class="input-group-text bg-light">
                    <i class="bi bi-whatsapp text-success"></i>
                  </span>
                  {{ form.whatsapp_url(class="form-control", placeholder="https://chat.whatsapp.com/...") }}
                </div>
                {% if form.whatsapp_url.errors %}
                  <div class="text-danger small mt-1">{{ form.whatsapp_url.errors[0] }}</div>
                {% endif %}
              </div>
            </div>

            <!-- Action Buttons -->
            <div class="text-center pt-4 border-top">
              <div class="btn-group" role="group">
                <a href="{{ url_for('club.view_club', club_id=club.id) }}" class="btn btn-outline-secondary btn-lg px-4">
                  <i class="bi bi-arrow-left me-2"></i>Cancelar
                </a>
                <button type="submit" class="btn btn-success btn-lg px-5 py-3">
                  <i class="bi bi-check-circle-fill me-2"></i>
                  {{ form.submit.label.text }}
                </button>
              </div>
              <div class="mt-3">
                <small class="text-muted">
                  <i class="bi bi-info-circle me-1"></i>
                  Solo administradores y creadores pueden editar el club
                </small>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
.section-header h5 {
  font-weight: 600;
}

.form-control:focus {
  border-color: var(--bs-success);
  box-shadow: 0 0 0 0.2rem rgba(var(--bs-success-rgb), 0.25);
}

.input-group-text {
  border-color: #dee2e6;
}

.card {
  border-radius: 1rem;
}

.card-header {
  border-radius: 1rem 1rem 0 0 !important;
}

.btn-success {
  background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
  border: none;
  border-radius: 0.5rem;
  font-weight: 600;
  transition: all 0.3s ease;
}

.btn-success:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(40, 167, 69, 0.4);
}

.btn-outline-secondary {
  border-radius: 0.5rem;
  font-weight: 600;
}
</style>
{% endblock %}