{% extends 'base.html' %}
{% block title %}Mi Espacio Personal{% endblock %}
{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/space.css') }}">
<script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
{% endblock %}
{% block content %}
<div class="ps-container" id="psContainer">
  <div class="ps-header d-flex justify-content-between align-items-center mb-3">
    <h1 class="h3 m-0">Mi Espacio Personal</h1>
    <div class="ps-buttons btn-group">
      <button class="btn btn-outline-primary" id="focusModeBtn">Modo Enfoque</button>
      <button class="btn btn-outline-secondary" id="darkModeToggle">Modo Oscuro</button>
      <button class="btn btn-primary" id="addBlockBtn">+ Añadir Bloque</button>
    </div>
  </div>

  <div id="smartSuggestions" class="d-none mb-3">
    <div class="suggestion-card" data-type="nota">
      <span>Bitácora inteligente</span>
      <button class="btn btn-sm btn-primary suggestion-apply">Aplicar</button>
    </div>
    <div class="suggestion-card" data-type="kanban">
      <span>Tablero Kanban</span>
      <button class="btn btn-sm btn-primary suggestion-apply">Aplicar</button>
    </div>
  </div>

  <div class="mochila-block card mb-3">
    <div class="card-body">
      <h6 class="card-title mb-2">Mi Mochila</h6>
      <a href="/mochila" class="btn btn-sm btn-primary">Abrir Mochila</a>
    </div>
  </div>

  <div id="emptyState" class="text-center py-5">
    <p class="mb-3">Este espacio está vacío.</p>
    <button class="btn btn-primary" id="startSpaceBtn">Comenzar mi espacio</button>
  </div>

  <div id="blocksContainer" class="blocks-grid"></div>

  <button class="btn btn-warning exit-focus-btn d-none" id="exitFocusBtn">Salir del modo enfoque</button>
</div>

<!-- Modal para elegir tipo de bloque -->
<div class="modal fade" id="addBlockModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Añadir bloque</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div class="modal-body">
        <div class="row g-2">
          <div class="col-6"><div class="block-option" data-type="nota">Bitácora</div></div>
          <div class="col-6"><div class="block-option" data-type="kanban">Kanban</div></div>
          <div class="col-6"><div class="block-option" data-type="meta">Meta</div></div>
          <div class="col-6"><div class="block-option" data-type="enlace">Acceso directo</div></div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
{% block scripts %}
<script src="{{ url_for('static', filename='js/space.js') }}"></script>
{% endblock %}
