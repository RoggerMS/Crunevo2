# Guidelines for Codex agents

- Always run `make fmt` and `make test` before committing.
- Use Tailwind CSS utilities when updating templates, but keep Bootstrap components unless instructed otherwise.
- Do not modify models or database migrations unless explicitly requested.
- The notes blueprint exposes both `notes.detail` and `notes.view_note` for `/notes/<id>`.
- Merge duplicated `DOMContentLoaded` listeners into a single entry point in `main.js`.
- All `<form method="post">` must import `components/csrf.html` and call
  `csrf_field()` immediately after the `<form>` tag.
- Nunca hacer CREATE TYPE sin comprobar si el tipo ya existe; usa IF NOT EXISTS o checkfirst=True.
- Se corrigi칩 la barra de navegaci칩n fija a침adiendo padding global y mejorando el men칰 m칩vil (PR navbar fixes).
- Se ajust칩 el padding global mediante CSS en el body y se agreg칩 z-index al navbar para evitar que tape el contenido.
- Se mejor칩 el cierre del men칰 m칩vil y se fij칩 la altura del navbar (PR navbar fixes 2).
- Se cierra el men칰 m칩vil al redimensionar la pantalla (PR navbar fixes 3).
- Se movi칩 el padding-top global al archivo style.css y se elimin칩 el bloque de
  estilos embebidos en base.html (PR navbar fixes 4).
- Se ajust칩 el `main` con padding-top en m칩viles y se quit칩 en pantallas
  mayores (PR navbar fixes 5).
- Se agreg칩 margen superior al `main` solo en escritorio con CSS
  (`@media (min-width: 992px)`)
- Se oculta `#mobileMenuOverlay` en escritorio y se ajusta el
  listener de redimensionado a 992px (PR overlay fix).
- Se establece `height` y `width` en 0 para `#mobileMenuOverlay` en
  escritorio y se asegura que `closeMenu()` a침ada `tw-hidden` (PR overlay fix 2).
- Se corrige la clase inicial de `#navLinks` para mostrarse horizontal en
  escritorio y se evita abrir el men칰 m칩vil en pantallas grandes
  (PR navbar desktop fix).
- Se establece `z-index: -1` y `position: static` para `#mobileMenuOverlay`
  en escritorio, previniendo que bloquee el contenido (PR overlay fix 3).
- Se asegura que `#navLinks` se coloque en `#desktopNavContainer` al cargar la
  p치gina y se oculta `#mobileMenuPanel` en escritorio (PR navbar panel fix).
- Se fuerzan `display: none` y `pointer-events: none` para `#mobileMenuOverlay`
  y `#mobileMenuPanel` en escritorio, actualizando `main.js` para aplicar estos
  estilos al cargar la p치gina y al cerrar el men칰 (PR overlay hide complete).

- Se agreg칩 "navbar_crunevo_fixed.html" como ejemplo de navbar fijo con men칰 m칩vil.
- Navbar migrado completamente a Bootstrap sin Tailwind ni overlay. Se elimin칩 el script de Tailwind y se simplific칩 main.js (PR bootstrap-only navbar).
- Implemented Tabler-based admin dashboard with new templates and blueprint enforcement.
- Fixed PDF upload to Cloudinary storing URL and adjusted templates (PR pdf-upload-fix).
- Restored Cloudinary upload logic in `notes_routes.py` to fix undefined variable error (PR notes-upload-fix).
- Improved PDF handling in notes: use `resource_type='auto'`, display inline with `<iframe>` and direct download link (PR notes-pdf-view).
- Enhanced notes upload error handling and download route: validate title, catch Cloudinary errors and serve local files with `send_file` (PR notes-error-handling).
- Updated notes detail template to embed PDFs with an `<iframe>` wrapped in `.ratio`, added fallback download link and removed duplicate buttons (PR pdf-viewer-fix).

- Confirmed notes upload uses `resource_type='auto'` for Cloudinary; recommended verifying URL uses '/raw/upload' (answer to resource_type question).
- Forced Cloudinary URLs for notes to use `resource_type='raw'` when generating
  `secure_url` (PR notes-raw-url).
- Ajustado el flujo de subida de PDF a Cloudinary para almacenar `resource_type='image'` en la URL principal. Esto permite visualizar correctamente el archivo en un `<iframe>` sin bloqueos por `/raw/upload`.
- Reemplazado iframe de detalle de nota para usar Google gview y permitir visualizaci칩n embebida (PR gview-iframe).
- Se integr칩 PDF.js como visor en `detalle.html`, cargando el primer canvas con el PDF y manteniendo enlace de descarga. (PR pdfjs-viewer)
- Integrado PDF.js de forma local y configurado worker en detalle.html (PR pdfjs-local).
- Corregido el path de `pdf.worker.min.js` en `detalle.html` para que PDF.js renderice correctamente (PR pdfjs-worker-path).
- Mejorado `upload.html` para usar tarjeta Bootstrap con `form-floating` y bot칩n primario (PR notes-upload-ui).
- Corregido include en manage_users.html eliminando 'with user=user' para evitar TemplateSyntaxError (PR manage-users-include-fix).
- Modernizado `upload.html` con tarjeta centrada y bot칩n ancho usando Bootstrap 5 (PR notes-upload-modern-card).
- El CSP ahora permite frames desde Cloudinary (PR cloudinary-frame-src).
- Verificada presencia de PDF.js local y worker (>100KB) y correcta configuraci칩n del visor en detalle.html. CSP mantiene Cloudinary en `img-src` y `frame-src` (QA pdfjs-check).
- CSP ampliado: `connect-src` incluye Cloudinary y `script-src`/`style-src` permiten CDN (PR cloudinary-csp-connect).

- Actualizado `<header>` en `admin/partials/topbar.html` con clase `navbar-light` (PR admin-topbar-light).
- Navbar ahora usa clase `navbar-crunevo` y `navbar-expand-md`, con iconos en cada enlace (PR navbar-icons).
- Implementado input r치pido en el feed para publicar texto e imagen o PDF, mostrando los 칰ltimos posts (PR feed-quick-input).
- Corregido url_for en pending.html para usar 'feed.index' y evitar BuildError (PR pending-home-link)
- A침adida secci칩n de destacados en el feed con notas m치s vistas, posts populares y usuarios con logros recientes (PR featured-posts)
- A침adido ranking semanal y logros recientes en el feed (PR weekly-ranking)
- Corregidos formularios del panel de administraci칩n: `manage_users` acepta
  POST, `user_actions.html` importa `csrf_field` y env칤a `user_id` (PR admin-fixes)
- Fixed feed template to handle posts without an author (PR orphan-posts-fix).
- Simplified author checks in feed template using a local variable (PR feed-author-var).
- Corregido el query de usuarios destacados para agrupar por usuario y ordenar por el logro m치s reciente (PR top-users-orderby-fix).

- Agregado endpoint `feed.view_post` con plantilla `post_detail.html` para ver publicaciones individuales (PR post-detail-route).
- Se unific칩 la ruta alias de `feed.view_post` usando <int:post_id> para evitar BuildError en templates.
- Se a침adi칩 prueba unitaria para verificar el alias `/posts/<id>` de `feed.view_post` (PR view-post-alias-test).
- Verificadas rutas del feed y sin reproducir BuildError; alias '/posts/<id>' activo (QA feed-view-post-check).

- Revalidado enlace a `feed.view_post`; no se reproduce BuildError y se mantiene alias `/posts/<id>` (QA feed-view-post-check 2).
- Prueba adicional confirma url_for("feed.view_post") genera /post/<id> (QA feed-view-post-check 3).
- Endpoint `feed.view_post` se define expl칤citamente en la ruta y se comprueba que la blueprint est치 registrada (QA feed-view-post-check 4).
- Layout updated to use `container-fluid px-md-5` and sidebars distributed per page with row/col system (PR full-width-layout).
- Se corrigi칩 la secci칩n de destacados en feed.html usando filas y columnas Bootstrap para mostrar tarjetas en tres columnas (PR feed-layout-fix).
- Se ajust칩 'feed.html' corrigiendo clases y confirmando las columnas de destacados (PR feed-layout-fix2).
- Ajustado el layout de destacados para distribuir correctamente las tarjetas en tres columnas (PR feed-layout-fix3).
- Verificada CSS global sin conflictos y la fila de destacados usa `row-cols-md-3` para asegurar las tres columnas (PR feed-layout-fix4).
- Ajustado layout de admin para separar navbar fijo y a침adir padding al contenido (PR admin-spacing-fix).
- Mejorado `base_admin.html` con padding horizontal en el main y sidebar con enlaces actualizados (PR admin-spacing-fix2).
- Admin layout now uses `page` and `page-wrapper`; sidebar muestra Cr칠ditos y Estad칤sticas (PR admin-page-wrapper).
- Agregado bloque de noticias en el feed principal para mostrar anuncios de CRUNEVO (PR feed-news-section)
- Se a침adieron likes y comentarios en las publicaciones del feed (PR feed-comments-likes)
- Panel admin redise침ado con Tabler: tema din치mico, sidebar ampliado y cards con shadow (PR admin-tabler-redesign).
- Sidebar del panel admin reorganizado con secciones y estilos para 칤conos alineados (PR admin-sidebar-design).
- Sidebar resalta enlace activo, toasts usan Bootstrap y topbar incluye bot칩n de tema (PR admin-sidebar-active).
- Layout de admin en dos columnas con sidebar fijo y topbar dentro de main. Sidebar usa `nav flex-column` (PR admin-sidebar-col-fix).
- A침adido sistema de navegaci칩n de secciones por botones en el feed (PR feed-section-buttons).
- Estructura de admin modernizada con Tabler 1.3.x: sidebar fijo, topbar simplificada y soporte de tema oscuro (PR admin-modern-layout).
- Fixed like_post to initialize likes when null (PR post-like-null-fix).
- Navbar principal se oculta en /admin usando un condicional en base.html (PR admin-navbar-hide).
- Implementado filtros r치pidos en el feed por query string (PR feed-quick-filters).
- Lista de apuntes ahora permite filtrar por recientes, m치s vistos y categor칤as y muestra tags en cada tarjeta (PR notes-filters).
- Apuntes admiten comentarios y reacci칩n con likes que se pueden quitar (PR notes-comments-likes).
- Gesti칩n de usuarios ahora incluye acciones r치pidas por fila con dropdown y modal para cambiar rol (PR user-quick-actions).
- Panel de productos en admin incluye edici칩n visual, eliminaci칩n segura y acceso directo a vista p칰blica (PR admin-product-actions).

- Panel de administraci칩n muestra tarjetas con m칠tricas de usuarios, apuntes, tienda, cr칠ditos y ranking (PR admin-dashboard-cards).
- Tienda actualizada con grilla Bootstrap y tarjetas con shadow en store.html y product_card.html (PR store-bootstrap-cards).
- A침adida vista de detalle de producto con ruta '/product/<id>' y enlace desde las tarjetas (PR store-product-detail).
- Carrito redise침ado con tabla responsive y controles de cantidad; nuevas rutas para modificar cantidades (PR cart-update).
- Panel de administraci칩n ahora incluye vista detallada de movimientos de cr칠ditos con tabla y raz칩n (PR admin-credits-history).
- Panel de administraci칩n permite exportar usuarios, cr칠ditos y productos a CSV (PR admin-exports).
- En el panel de productos se corrigi칩 el enlace a la vista p칰blica usando `store.product_detail` (PR admin-product-link-fix).
- Eliminada la funci칩n `create_tables_once` en app.py para evitar timeouts; las tablas se gestionan con migraciones (PR app-init-fix).
- Added Fly.io troubleshooting steps for Postgres connection errors in README (PR fly-release-troubleshooting).
- Updated Fly.io docs to reference `crunevo-db.internal` (PR fly-db-internal-fix).
- Onboarding tokens now use `secrets.token_urlsafe(32)` and no longer encode the email (PR onboarding-token-length).
- Comment form listener now checks element existence with optional chaining in `detalle.html` (PR comment-form-null-check).
- Removed unused today variable from trending route in feed_routes.py (PR trending-today-remove).
- En `add_product` se castea `price` a float y `stock` a int antes de crear el producto (PR admin-add-product-cast).
- Dashboard incluye gr치ficas de usuarios, apuntes, cr칠ditos y productos usando Chart.js (PR admin-dashboard-charts)
- Corregido _fill_series en products_last_3_months pasando 'rows' (PR admin-stats-bugfix)
- Admin panel moved to subdomain burrito.crunevo.com with dedicated Fly app (PR admin-subdomain).
- Panel de administraci칩n aislado por completo en burrito.crunevo.com; /admin no se registra en el dominio principal y navbar p칰blico sin enlace Admin (PR admin-isolation).
- Pantalla de login exclusiva para admins en /login, redirige al dashboard y se bloquea /admin en www (PR admin-login-isolation).
- Verificada configuraci칩n ADMIN_INSTANCE=1 en fly-admin.toml y wsgi_admin.py; login redirige al dashboard y blueprint admin se registra solo en modo admin (QA admin-config-check).
- Confirmado FLASK_APP usa "crunevo.wsgi_admin:app" y create_app separa blueprints seg칰n ADMIN_INSTANCE (QA admin-env-check).
- wsgi_admin.py simplificado para importar create_app desde crunevo.app sin variables extra y se verific칩 FLASK_APP en fly-admin.toml (QA admin-wsgi-cleanup).

- Dockerfile now reads FLASK_APP to run gunicorn, enabling admin instance to use wsgi_admin (PR admin-gunicorn-env).
- Updated create_app to use `is_admin` flag and ensure admin blueprints load only when ADMIN_INSTANCE=1. wsgi_admin.py now sets this variable explicitly (PR admin-blueprint-filter).
- Updated wsgi.py to import create_app from crunevo.app and set FLASK_APP to 'crunevo.wsgi:app' in fly.toml to ensure Gunicorn loads the app correctly (PR wsgi-app-fix).
- Confirmed admin instance loads wsgi_admin via fly-admin.toml and blueprints register only in that mode (QA admin-deploy-fix).
- wsgi_admin.py ahora establece ADMIN_INSTANCE antes de importar create_app para evitar que el panel admin muestre el feed p칰blico (PR wsgi-admin-env-order).
- Health check blueprint registered globally and Fly admin HTTP checks configured. Added console log for instance mode (PR admin-health-check).
- Agregado PUBLIC_BASE_URL en config, context processor e enlace absoluto en manage_store para acceder a la tienda p칰blica desde admin.
- Enlaces de perfil y productos en plantillas admin ahora usan PUBLIC_BASE_URL para apuntar al dominio p칰blico (PR admin-absolute-links2).
- Implementados logs de productos, notificaciones internas y rol de moderador con modo lectura en admin (PR admin-logs-moderator).
- Health check no redirige a HTTPS para pasar comprobaciones HTTP (PR health-check-http).
- Fixed inactive dropdowns on admin tables by initializing via main.js and adding tooltips (PR admin-dropdowns-init).
- Mejorado dise침o visual del panel admin: contraste, colores y botones en modo claro/oscuro (PR admin-ui-polish).
- Sidebar dark theme polished and dropdowns reinitialized after DataTable events, with theme toggle icon updates (PR admin-dark-dropdown-fix).
- Arreglados dropdowns en tablas con getOrCreateInstance y fondo oscuro uniforme en main y tarjetas (PR admin-dropdown-dark-bg).
- Mejorados badges de rol, icono de tema, padding inferior y estilos de main seg칰n tema (PR admin-ui-accessibility-fix).
- Ajustados estilos oscuros de cards y badges, y se forz칩 fondo oscuro en sidebar para cubrir franjas blancas (PR admin-dark-ui-tweak).
- Dropdown de "M치s opciones" ocultando tooltip activo y reinicializado tras DataTables; fondo oscuro global en body y container (PR admin-dropdown-tooltip-fix).
- Contraste de hover en el sidebar oscuro, min-height para page-content y textos muted claros; funciones de dropdowns y datatables movidas a admin_ui.js (PR admin-layout-tweak).
- Reparado dropdown de "M치s opciones" en tablas admin, corrigiendo conflictos con DataTables y tooltips (PR admin-dropdown-final-fix).
- Ajustado soporte de modo oscuro en feed, apuntes y tienda (PR dark-theme-fix)
- Ensured dropdown containers use position-relative to properly render menus (QA admin-dropdown-container).
- Prevented duplicate dropdown instances by checking getInstance first (QA admin-dropdown-instance-check).
- Avoided tooltip duplication by verifying getInstance and binding show event once (QA admin-tooltip-instance-fix).
- Implemented ranking with tabs and achievements section (PR ranking-achievements).
- Integrado Resend como proveedor de emails y verificaci칩n en registro (PR resend-email-provider).
- Fixed feed weekly ranking query removing nonexistent achievement join (PR achievement-table-fix).
- Fixed profile achievements include syntax and feed loop for recent achievements (PR profile-feed-jinja-fix).
- Updated profile templates to use a.badge_code and redesigned personal profile with activity dashboard (PR profile-redesign).
- Fixed slice syntax in perfil.html loops by assigning sorted lists before slicing to avoid TemplateSyntaxError (PR profile-slice-fix).
- Registro permite subir avatar opcional y username 칰nico; perfil muestra @username y acepta nueva foto (PR profile-avatar-upload).
- Avatar por defecto se asigna autom치ticamente si no se sube imagen en el registro (PR default-avatar).
- Registro renovado con tarjeta responsiva, vista previa de avatar y aviso si falla Resend (PR registro-ui-email-fix).
- Implemented secure admin route to send custom emails with preview and sidebar link (PR admin-email-sender).
- Onboarding finish page redesigned with avatar file/url preview and card layout (PR onboarding-finish-ui).
- Ruta /register no se registra en la instancia admin; el registro s칩lo est치 disponible en /onboarding/register del dominio p칰blico y el login del admin sigue limitado a roles admin o moderador (PR remove-admin-register).
- Pantalla de login renovada con tarjeta doble y estilos responsive; se a침adi칩 login.css (PR login-page-redesign).
- Login page updated with transparent card and centered mobile layout (PR login-transparent-blur).
- Register page redesigned with transparent card and additional fields (PR register-redesign).
- Unified registration under /onboarding/register and removed /register route (PR register-unification).
- Login y registro comparten fondo degradado, tarjetas trasl칰cidas centradas y soporte de modo oscuro (PR login-register-theme).
- Se corrigi칩 el fondo oscuro en login y registro y se actualiz칩 el logo en login (PR login-register-dark-logo).
- Nuevo correo de confirmaci칩n con plantilla HTML y confirm_url externo; asunto actualizado (PR confirm-email-html).
- Mejorado login y registro con tarjeta transl칰cida, ocultar navbar, alternar contrase침a y soporte m칩vil (PR login-register-ux).
- Optimized login and register pages with smoother theme transitions, rotating welcome phrases and accessible password toggles using 游뗽/游뗻 icons. Dark mode styling fixed (PR login-register-polish).
- Adjusted dark theme backgrounds to true black, improved password toggle alignment and link contrast, added fading welcome phrase rotation and disabled page scrolling (PR login-register-tweak).
- Added theme toggle button on login and register pages, refined dark mode card translucency, extended welcome phrase interval and improved link contrast (PR login-register-theme-toggle).
- Fixed dark theme backgrounds on login and register: body black, wrappers transparent, cards darker (PR login-register-dark-fix).
- Ensured gradient removed in dark mode on login and register, toggle icon updates with stored preference (PR login-register-gradient-fix).
- Corrigidos estilos de login y registro: fondo negro s칩lido en modo oscuro, frase estable y tema guardado en localStorage (PR login-register-stability-fix).
- Tienda actualizada: precios en soles, canje con cr칠ditos y modelo Purchase; panel admin gestiona precio_creditos y flags (PR store-credits).
- Lista de productos redise침ada con tarjetas responsive y badges; agregado store.css para estilos de tienda (PR store-layout).
- Vista de producto redise침ada con imagen grande, badges y botones (PR store-product-page).
- Corregido enlace a detalle de producto en store.html usando 'store.view_product' para evitar BuildError (PR store-detail-link-fix).
- Vista del carrito modernizada con tabla responsive, totales y botones de acci칩n (PR cart-ui-update).
- Documentada propuesta integral de redise침o de la tienda en docs/store_proposal.md.
- Vista de tienda redise침ada completamente con panel lateral de filtros (categor칤a, precio, cr칠ditos), cuadr칤cula moderna de productos y layout limpio centrado en e-commerce educativo (PR store-redesign-ux).
- Sidebar de tienda reemplazado por men칰 exclusivo con enlaces de carrito, compras y filtros r치pidos (PR store-sidebar).
- Ficha de producto modernizada con secci칩n de caracter칤sticas y stock (PR store-product-detail-redesign).
- Sistema de favoritos funcional con modelo FavoriteProduct, rutas y iconos de coraz칩n (PR store-favorites).
- Filtros por categor칤a y precio habilitados en la tienda (PR store-filters).
- Historial de compras accesible en /store/compras con tarjetas de detalle y opci칩n de descarga (PR store-purchases-page).
- Checkout real crea registros en Purchase y descuenta stock; bot칩n "Comprar ahora" en productos (PR real-checkout).
- Corregido enlace de eliminar del carrito para usar store.remove_item y evitar BuildError (PR fix-cart-remove-link).
- Agregados alias price_paid y credits_used en Purchase, p치gina de 칠xito para checkout y botones de tienda deshabilitados si no hay stock o cr칠ditos insuficientes (PR checkout-success-ui).
- Canje con cr칠ditos descuenta stock y previene duplicados usando allow_multiple; checkout desde carrito requiere confirmaci칩n (PR store-redeem-cart-checkout).
- Bot칩n 'M치s opciones' en /admin/store permite editar y eliminar productos con modal de confirmaci칩n (QA admin-store-options).
- Eliminadas duplicaciones de Bootstrap quitando tabler.min.js y moviendo modales fuera de las tablas (PR admin-dropdown-conflict-fix).
- Historial de compras permite descargar comprobante en PDF y compartir enlace; productos comprados muestran badge "Adquirido" y deshabilitan compra/canje si no se permiten duplicados. Tras comprar o canjear se ofrece descarga directa cuando hay archivo (PR purchased-badge-download).
- Corregido enlace 'Ver en tienda' en manage_store.html a /store/product/<id> para evitar redirecci칩n rota (PR admin-store-view-link-fix).
- Mejorada secci칩n de favoritos con botones r치pidos, badges y descarga integrada (PR store-favorites-actions).
- Sidebar de tienda muestra categor칤as din치micas y filtros r치pidos Top/Free/Pack; ruta store_index admite ?top=1, ?free=1 y ?pack=1 (PR store-sidebar-filters).
- Bot칩n de descarga disponible en tarjetas de tienda, favoritos y p치gina de producto si ya fue adquirido (PR store-download-btn).
- Historial de compras filtrable por fecha (7 d칤as, mes actual, 3 meses) (PR purchases-date-filter).
- En edici칩n de productos se sube imagen a Cloudinary y el enlace "Ver en tienda" apunta a /store/product/<id> (PR product-cloudinary-fix).
- Implementado sistema de rese침as y preguntas en productos con filtros en favoritos y visual especial para Packs (PR store-reviews-qa).
- Corregida vista de tienda para mostrar product.image_url con imagen por defecto si falta (PR store-image-url)
- Feed redesign: avatar en formulario de publicaci칩n, filtros como pesta침as y fechas relativas (PR feed-v1-improved)
- Corregida plantilla store.html para usar product.image si existe, con alt y title; bot칩n "Ver detalle" evita desbordes con tw-whitespace-nowrap (PR store-image-check)
- Added SavedPost model, donation endpoints and mobile nav.
- A침adido soporte de tema oscuro para textos grises en tarjetas del feed (PR dark-text-support).
- Feed principal reorganizado para mostrar solo publicaciones recientes con paginaci칩n b치sica y sin secciones de apuntes (PR feed-wall-redesign).
- Restaurado sistema de pesta침as en el feed con secciones din치micas y etiqueta "游닉 Publicaci칩n" en lugar de "游닇 Apunte" (PR feed-tabs-restore).
- Redise침ada p치gina /trending con vista propia y posts ordenados por likes (PR trending-redesign)
- Vista individual de post ahora incluye bot칩n de compartir y enlace a m치s publicaciones del autor; se a침adi칩 ruta feed.user_posts y se muestran 0 likes por defecto (PR post-page-share).
- Added share buttons, dynamic comments via AJAX and bottom-right toasts with Open Graph meta (PR feed-share-toasts).
- Sidebar right now highlights weekly top posts and shows achievements on mobile; posts include "Ver publicaci칩n" button and badge restyled (PR feed-highlights).
- Public profile links now use usernames, new profile page lists notes, posts and achievements, and feed posts include a "Ver perfil" button. Added user notes route (PR feed-profile-links).
- Redesigned public profile with larger avatar, achievements grid and posts/notes sections. Added /perfil/<username>/apuntes route and updated templates to use profile_by_username links (PR public-profile-redesign).
- Fixed public profile template to avoid Jinja 'with' syntax (PR profile-jinja-fix).
- Implemented basic user notification system with model, utility, routes and navbar indicator (PR notifications-basic).
- Added migration for notifications table to fix runtime errors (QA notifications-migration).

- Added quick filter sidebar on feed, PDF preview on upload form, chat messages with timestamps and notifications on comments/messages (PR feed-sidebar-chat-preview).
- Sidebar derecho unificado: apuntes, logros y ranking en una sola card; se elimin칩 bloque duplicado de logros en el feed (PR sidebar-right-unify).
- Removed mobile duplicate notes/achievements block from feed (PR feed-mobile-cleanup).
- Added weekly missions feature with models, routes, template and navbar link (PR missions-basic).
- Chat page now shows an 'En construcci칩n' message and no longer provides messaging UI (PR chat-placeholder).
- Precios en store.html ahora muestran "S/ 0" cuando el producto es gratuito (PR store-free-price).

- Corrigio plantillas de tienda para usar `product.price` en lugar de `price_soles` evitando UndefinedError (PR store-price-fix).
- Se movi칩 la secci칩n "칔ltimos apuntes" del feed a /apuntes y se mejor칩 el sidebar con botones. Las tarjetas de apuntes cargan vista previa PDF usando PDF.js. Productos de la tienda muestran "Desde S/ 0", badge de categor칤a y bot칩n de compartir (PR feed-store-pdf-preview).
- Implementado sistema completo de ranking y logros con p치gina /ranking, asignaci칩n autom치tica y panel admin (PR achievements-ranking-v1).
- Reestructurado el feed con secci칩n de apuntes en la barra lateral, logros con iconos y /trending mostrando publicaciones destacadas de la semana (PR feed-restructure-notes).
- A침adido dropdown de notificaciones con actualizaci칩n AJAX y bot칩n "Marcar todo como le칤do" (PR dynamic-notifications).
- Mejora de subida de apuntes: admite im치genes, vista previa y spinner en el bot칩n (PR notes-upload-preview).
- Mejorados filtros r치pidos del feed con botones toggle y carga AJAX (PR feed-toggle-filters)
- Added ChatCrunevo page using OpenRouter API, shortcut /notes/populares and share link button on note detail (PR ia-chat-popular-notes).
- Feed principal limpiado quitando secciones de apuntes, logros y ranking; /notes redise침ado como cat치logo con tarjetas de vista previa, filtros por likes y ruta /notes/tag/<tag> (PR notes-catalog-redesign).
- SEO meta description actualizada y ruta '/' muestra login o feed seg\u00fan autenticaci\u00f3n (PR root-login-seo-fix).
- Redise침o del feed con barra lateral de iconos, filtros m칩viles y tarjetas de publicaciones mejoradas (PR feed-redesign-v2).
- Feed index moved to /feed with new sidebar and post card templates (PR modern-feed).
- Corregido view_feed para retornar feed_items y sidebar derecho simplificado (PR feed-view-feed-fix).
- Navbar cleaned removing missions link and verification badge; missions now reside under /perfil with new tab and verification check shown next to usernames (PR profile-missions-verification).
- Mejorada subida de im치genes en el feed con vista previa y spinner; filtros r치pidos redise침ados y se elimin칩 HTML obsoleto al final del feed (PR feed-todo-fix).
- Corregido tama침o del preview de im치genes, se ajustaron las publicadas y se limpiaron restos de HTML en el feed (PR feed-image-preview-fix).

- Verificada ruta view_feed y plantillas para usar solo feed_items sin apuntes extra (QA feed-view-feed-admin-check).
- Filtrado de "apuntes" en FeedItem: el feed y la API ahora omiten notas antiguas incluso para administradores (PR feed-skip-notes).
- Se a침adi칩 opci칩n para eliminar publicaciones propias en el feed, removiendo FeedItem y cache (PR post-delete).
- A침adida funcionalidad para que los usuarios eliminen sus propios apuntes desde /notes y /perfil (PR notes-delete-user).
- Bot칩n "Editar" agregado en publicaciones del feed con marca visual (Editado) y control de permisos (PR post-edit).
- Estilo CSS actualizado para centrar im치genes del feed y mejorar visualizaci칩n m칩vil (PR feed-image-center).
- Se a침adi칩 bot칩n "Reportar" en apuntes y publicaciones con modal y notificaci칩n al admin. Se habilit칩 ruta /notes/edit/<id> para editar t칤tulo, descripci칩n, categor칤a y etiquetas (PR note-edit-report).
- Sidebar de /feed/trending simplificado: solo filtros r치pidos, formulario de publicaci칩n igual al feed y filtros m칩viles (PR trending-sidebar-cleanup).
- Ajustado ancho de detalle de apunte con container-xl y bot칩n de descarga centrado (PR note-detail-width-fix).
- Actualizado dise침o de la tienda con grilla responsiva y tarjetas con borde morado; footer incluye acciones de detalle y compartir (PR store-grid)
- Mejorado layout de tienda y favoritos usando container-fluid, textos truncados con line-clamp y tarjetas pulidas (PR store-layout-polish)
- Nombres de productos con hasta 3 l칤neas y tama침o 1rem; secci칩n derecha muestra tarjetas de destacados con mensaje vac칤o y bot칩n "Ver" (PR store-featured-redesign)
- L칤mite de 3 productos destacados con aviso en add_edit_product y verificaci칩n al guardar (PR featured-limit).
- P치gina de administraci칩n de tienda muestra badges de Destacado, Popular, Nuevo y Stock bajo en una columna "Etiquetas" con tooltips. Productos se ordenan por etiquetas (PR admin-store-badges-enhancement).
- Secci칩n de destacados en la tienda convertida en carrusel horizontal con scroll y sin l칤mite de productos (PR store-featured-carousel).
- Eliminado l칤mite de 3 productos destacados en admin; ahora se pueden marcar todos los que se deseen (PR admin-featured-limit-removed).
- Carrusel de destacados movido antes del t칤tulo de tienda y tarjetas m치s compactas (PR store-featured-move-reduce).
- Correcci칩n de ordenamiento en admin/manage_store para manejar valores None (PR admin-store-sort-none-fix).
- Mejorado carrusel de destacados con tarjetas modernas, im치genes cuadradas y contenedor con sombra (PR store-featured-card-style).
- Input de imagen del feed usa id "feedImageInput" y contenedor "previewContainer" con vista previa instant치nea (PR feed-image-preview-fix).
- Implementado modo oscuro en feed y tienda, scroll infinito e overlay m칩vil con offcanvas. A침adidas im치genes lazy (PR dark-scroll-overlay).
- Ajustado modo oscuro en tienda y feed: bg-light adaptativo, botones claros y navbar inferior con bg-body (PR dark-mode-fixes).
- Feed mejorado: filtros por categor칤a, buscador interno y sidebar m칩vil en offcanvas con bot칩n flotante. Animaciones desactivadas en dispositivos lentos y carga infinita usando categor칤a. (PR feed-mobile-overlay)
- Corregido include en feed/index.html eliminando 'with categoria=categoria' para evitar TemplateSyntaxError (PR feed-sidebar-with-fix).
- Men칰 m칩vil del navbar ahora usa fondo morado con clase `offcanvas-crunevo` y los dropdowns comparten ese color. Botones flotantes de sidebar m칩vil cambian a icono de filtro y clase `mobile-overlay-btn` (PR overlay-menu-color).
- Tienda muestra precios en destacados, bot칩n "+ Carrito" con AJAX y contador en el navbar y bot칩n flotante (PR store-cart-indicators).
- Fondo del offcanvas m\xc3\xb3vil del navbar ahora cubre todo el cuerpo y enlaces permanecen en blanco; clase ajustada en navbar.html (PR offcanvas-bg-full).

- Men칰 m칩vil del navbar actualizado para cubrir toda la pantalla con fondo morado transl칰cido y texto legible; estilos en navbar.css. (PR mobile-offcanvas-fix)
- Men칰 hamburguesa y offcanvas del navbar eliminados en m칩viles; botones ocultos con CSS y marcado retirado. (PR remove-mobile-offcanvas)
- Navbar inferior m칩vil implementado con mobile_bottom_nav.html e incluido en base.html. (PR bottom-nav-mobile)
